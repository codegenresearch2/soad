from flask import Flask, jsonify, render_template, request\" from sqlalchemy.orm import sessionmaker\" from sqlalchemy import create_engine, func\" from database.models import Trade, AccountInfo, Balance, Position\" import os\n\napp = Flask('TradingAPI', template_folder='ui/templates')\n\nDATABASE_URL = 'sqlite:///trading.db'\nengine = create_engine(DATABASE_URL)\nSession = sessionmaker(bind=engine)\n\n@app.route('/position_page')\ndef positions():\n    try:\n        return render_template('positions.html')\n    except Exception as e:\n        app.logger.error(f'Error rendering index.html: {e}')\n        return 'Internal Server Error', 500\n\n@app.route('/')\ndef index():\n    try:\n        return render_template('index.html')\n    except Exception as e:\n        app.logger.error(f'Error rendering index.html: {e}')\n        return 'Internal Server Error', 500\n\n@app.route('/trades_per_strategy')\ndef trades_per_strategy():\n    session = Session()\n    try:\n        trades_count = session.query(Trade.strategy, Trade.broker, func.count(Trade.id)).group_by(Trade.strategy, Trade.broker).all()\n        trades_count_serializable = [{"strategy": strategy, "broker": broker, "count": count} for strategy, broker, count in trades_count]\n        return jsonify({"trades_per_strategy": trades_count_serializable})\n    finally:\n        session.close()\n\n@app.route('/historic_balance_per_strategy', methods=['GET'])\ndef historic_balance_per_strategy():\n    session = Session()\n    try:\n        historical_balances = session.query(\n            Balance.strategy,\n            Balance.broker,\n            func.strftime('%Y-%m-%d %H', Balance.timestamp).label('hour'),\n            Balance.total_balance,\n        ).group_by(\n            Balance.strategy, Balance.broker, 'hour'\n        ).order_by(\n            Balance.strategy, Balance.broker, 'hour'\n        ).all()\n        historical_balances_serializable = []\n        for strategy, broker, hour, total_balance in historical_balances:\n            historical_balances_serializable.append({\